(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const v={username:"arafat",password:"Arafat@123456",maxAttempts:5,lockoutTime:3e4};let w=0,T=!1,D=null;const O=["üö´ Nice try, but that's not it! Are you even trying?","ü§î Hmm... my grandma could guess better than that!","üòÖ Wrong! Did you try turning your brain off and on again?","üé≠ Impostor detected! The real agent would know the password!","üôà That password is so wrong, even the AI is embarrassed for you!","üîê Access denied! The password fairy says NO!","ü§ñ Beep boop! Human authentication failed. Are you a robot?","üïµÔ∏è Our spy satellites confirm: you're not authorized!","üíÄ That password just died of embarrassment!","üé™ Welcome to the circus of wrong passwords!"],$=["üí° Fun fact: This AI once calculated pi to 1 million digits... just for fun!","üß† Fun fact: The AI has read more books than a library full of bookworms!","üöÄ Fun fact: This AI dreams in binary and speaks in emojis!","üéÆ Fun fact: The AI beat every video game... in its imagination!","üçï Fun fact: If this AI could eat, it would definitely choose pizza!","üåç Fun fact: This AI knows 47 ways to say 'Hello' in alien languages!","üé∏ Fun fact: The AI's favorite band is 'The Debugging Beatles'!","‚òï Fun fact: This AI runs on coffee... wait, that's the developer!","ü¶Ñ Fun fact: The AI believes in unicorns. Don't tell it they're not real!","üé¨ Fun fact: The AI's favorite movie is 'The Matrix'... for obvious reasons!"];function F(){const e=sessionStorage.getItem("arafatGPT_authenticated")==="true",t=document.getElementById("login-overlay"),n=document.getElementById("app-container");e?(t.classList.add("hidden"),n.style.display="flex",W()):(t.classList.remove("hidden"),n.style.display="none",U())}function ne(e){if(e.preventDefault(),T)return k("‚è∞ Whoa there, speed demon! Take a breather and try again soon!"),!1;const t=document.getElementById("login-username").value.trim().toLowerCase(),n=document.getElementById("login-password").value,s=document.getElementById("login-btn"),o=s.querySelector(".btn-text"),i=s.querySelector(".btn-loading");return o.classList.add("hidden"),i.classList.remove("hidden"),s.disabled=!0,setTimeout(()=>{t===v.username&&n===v.password?oe():se(),o.classList.remove("hidden"),i.classList.add("hidden"),s.disabled=!1},800),!1}function oe(){const e=document.querySelector(".login-container"),t=document.getElementById("login-overlay");sessionStorage.setItem("arafatGPT_authenticated","true"),e.classList.add("success"),k("‚úÖ Welcome, Agent! Initiating neural link...",!0),setTimeout(()=>{t.classList.add("hidden"),document.getElementById("app-container").style.display="flex",W(),m("üéâ Welcome aboard, Agent Arafat! The AI awaits your commands!","success")},800)}function se(){w++;const e=document.getElementById("login-btn"),t=document.querySelector(".login-container");e.classList.add("shake"),t.style.animation="none",setTimeout(()=>{t.style.animation="",e.classList.remove("shake")},500);const n=O[Math.floor(Math.random()*O.length)];k(n),ae(),w>=v.maxAttempts&&ie(),U()}function k(e,t=!1){const n=document.getElementById("login-error");n.textContent=e,n.style.borderColor=t?"#22c55e":"#ef4444",n.style.background=t?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",n.style.color=t?"#22c55e":"#ef4444",n.classList.add("visible")}function ae(){const e=document.getElementById("attempts-counter"),t=v.maxAttempts-w;t>0?e.textContent=`‚ö†Ô∏è ${t} attempt${t!==1?"s":""} remaining before temporary lockout!`:e.textContent="üîí Too many attempts! Cooling down..."}function ie(){T=!0;const e=document.getElementById("attempts-counter");let t=v.lockoutTime/1e3;k("üîí Slow down there, cowboy! Too many wrong guesses!");const n=()=>{e.textContent=`‚è∞ Try again in ${t} seconds... (Grab some coffee ‚òï)`,t--,t<0&&(clearInterval(D),T=!1,w=0,e.textContent="üîì You're unlocked! Give it another shot!",document.getElementById("login-error").classList.remove("visible"))};n(),D=setInterval(n,1e3)}function U(){const e=document.getElementById("fun-fact"),t=$[Math.floor(Math.random()*$.length)];e.textContent=t}function re(){const e=document.getElementById("login-password"),t=document.getElementById("eye-icon");e.type==="password"?(e.type="text",t.textContent="üôà"):(e.type="password",t.textContent="üëÅÔ∏è")}function ce(){sessionStorage.removeItem("arafatGPT_authenticated"),document.getElementById("login-overlay").classList.remove("hidden"),document.getElementById("app-container").style.display="none",document.getElementById("login-username").value="",document.getElementById("login-password").value="",document.getElementById("login-error").classList.remove("visible"),w=0,m("üëã See you later, Agent! The AI will miss you!","info")}const j={apiUrl:"https://chat.arafatops.com",defaultModel:"claude-sonnet-4-5",maxTokens:16384,showThinking:!0,autoScroll:!0};let r={...j},d={},p=null,C=!1,y=null,g=[];document.addEventListener("DOMContentLoaded",()=>{F()});function W(){de(),he(),f(),Q(),le();const e=localStorage.getItem("lastConversationId");e&&d[e]&&B(e),marked.setOptions({highlight:function(n,s){if(s&&hljs.getLanguage(s))try{return hljs.highlight(n,{language:s}).value}catch{}return hljs.highlightAuto(n).value},breaks:!0,gfm:!0});const t=document.getElementById("message-input");t&&t.addEventListener("input",A)}function le(){const e=document.getElementById("right-sidebar"),t=document.getElementById("robot-mascot");e&&t&&(e.classList.contains("closed")?t.classList.add("hidden-by-sidebar"):t.classList.remove("hidden-by-sidebar"))}function de(){const e=localStorage.getItem("arafatChatConfig");e&&(r={...j,...JSON.parse(e)}),document.getElementById("model-select").value=r.defaultModel,R()}function ue(){localStorage.setItem("arafatChatConfig",JSON.stringify(r))}function G(){document.getElementById("settings-api-url").value=r.apiUrl,document.getElementById("settings-default-model").value=r.defaultModel,document.getElementById("settings-max-tokens").value=r.maxTokens,document.getElementById("settings-show-thinking").checked=r.showThinking,document.getElementById("settings-auto-scroll").checked=r.autoScroll,document.getElementById("settings-modal").classList.add("active")}function x(){document.getElementById("settings-modal").classList.remove("active")}function me(){r.apiUrl=document.getElementById("settings-api-url").value.trim(),r.defaultModel=document.getElementById("settings-default-model").value,r.maxTokens=parseInt(document.getElementById("settings-max-tokens").value)||8192,r.showThinking=document.getElementById("settings-show-thinking").checked,r.autoScroll=document.getElementById("settings-auto-scroll").checked,ue(),document.getElementById("model-select").value=r.defaultModel,x(),m("Settings saved successfully","success"),Q()}function ge(){const e=document.documentElement,n=e.getAttribute("data-theme")==="dark"?"light":"dark";e.setAttribute("data-theme",n),localStorage.setItem("theme",n),R()}function R(){const e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e);const t=document.getElementById("theme-text");t&&(t.textContent=e==="dark"?"Light Mode":"Dark Mode")}function he(){const e=localStorage.getItem("arafatChatConversations");e&&(d=JSON.parse(e))}function E(){localStorage.setItem("arafatChatConversations",JSON.stringify(d))}function pe(){return"conv_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}function z(){const e=pe();d[e]={id:e,title:"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()},E(),B(e),f(),we()}function B(e){p=e,localStorage.setItem("lastConversationId",e);const t=d[e];if(!t)return;const n=document.getElementById("chat-container");n.innerHTML="",t.messages.length===0?n.innerHTML=M():t.messages.forEach(s=>{K(s.role,s.content,s.images,s.thinking)}),f()}function fe(e,t){if(t.stopPropagation(),!!confirm("Delete this conversation?")){if(delete d[e],E(),p===e){p=null;const n=document.getElementById("chat-container");n.innerHTML=M()}f(),m("Conversation deleted","success")}}function ye(e,t){if(!d[e])return;let n=t.substring(0,50);t.length>50&&(n+="..."),d[e].title=n,d[e].updatedAt=Date.now(),E(),f()}function f(){const e=document.getElementById("conversations-list"),t=Object.values(d).sort((n,s)=>s.updatedAt-n.updatedAt);if(t.length===0){e.innerHTML='<div style="padding: 20px; text-align: center; color: var(--text-muted); font-size: 14px;">No conversations yet</div>';return}e.innerHTML=t.map(n=>`
        <div class="conversation-item ${n.id===p?"active":""}"
             onclick="loadConversation('${n.id}')">
            <span class="conv-icon">üí¨</span>
            <span class="conv-title">${H(n.title)}</span>
            <button class="conv-delete" onclick="deleteConversation('${n.id}', event)" title="Delete">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            </button>
        </div>
    `).join("")}function ve(){confirm("This will delete ALL conversations. Are you sure?")&&(d={},p=null,localStorage.removeItem("arafatChatConversations"),localStorage.removeItem("lastConversationId"),document.getElementById("chat-container").innerHTML=M(),f(),x(),m("All data cleared","success"))}function we(){const e=document.getElementById("right-sidebar");e&&e.classList.remove("mobile-visible")}function be(e){Array.from(e.target.files).forEach(n=>{if(!n.type.startsWith("image/")){m("Please select an image file","error");return}if(n.size>20*1024*1024){m("Image must be less than 20MB","error");return}const s=new FileReader;s.onload=o=>{const i=o.target.result;g.push({type:"base64",media_type:n.type,data:i.split(",")[1]}),L()},s.readAsDataURL(n)}),e.target.value=""}function L(){const e=document.getElementById("image-preview-container");e.innerHTML=g.map((t,n)=>`
        <div class="image-preview">
            <img src="data:${t.media_type};base64,${t.data}" alt="Preview">
            <button class="remove-image" onclick="removeImage(${n})">√ó</button>
        </div>
    `).join("")}function Ie(e){g.splice(e,1),L()}async function J(){const e=document.getElementById("message-input"),t=e.value.trim();if(!t&&g.length===0||C)return;if(!r.apiUrl){m("Please configure API URL in Settings","error"),G();return}p||z();const n=d[p],s=document.getElementById("welcome-screen");s&&s.remove();let o=[];g.length>0&&g.forEach(a=>{o.push({type:"image",source:{type:"base64",media_type:a.media_type,data:a.data}})}),t&&o.push({type:"text",text:t});const i={role:"user",content:o.length===1&&o[0].type==="text"?t:o,images:g.length>0?[...g]:void 0};n.messages.push(i),n.messages.length===1&&ye(p,t||"Image message"),K("user",t,g),e.value="",e.style.height="auto",g=[],L(),A();const l=n.messages.map(a=>({role:a.role,content:a.content}));C=!0,q(!0);const c=document.getElementById("model-select").value;try{y=new AbortController;const a=await fetch(`${r.apiUrl}/v1/messages`,{method:"POST",headers:{"Content-Type":"application/json","anthropic-version":"2023-06-01","ngrok-skip-browser-warning":"true"},body:JSON.stringify({model:c,max_tokens:r.maxTokens,stream:!0,messages:l}),signal:y.signal});if(!a.ok){const u=await a.json();throw new Error(u.error?.message||`HTTP ${a.status}`)}await ke(a,n)}catch(a){a.name==="AbortError"?m("Generation stopped","warning"):(console.error("Error:",a),m(a.message,"error"),Te(a.message))}finally{C=!1,y=null,q(!1),E()}}async function ke(e,t){const n=e.body.getReader(),s=new TextDecoder;let o="",i=null,l=null,c=null,a="",u="";for(;;){const{done:ee,value:te}=await n.read();if(ee)break;o+=s.decode(te,{stream:!0});const N=o.split(`
`);o=N.pop()||"";for(const P of N){if(!P.startsWith("data: "))continue;const _=P.slice(6);if(_!=="[DONE]")try{const h=JSON.parse(_);switch(h.type){case"message_start":i=Z("assistant"),document.getElementById("chat-container").appendChild(i);break;case"content_block_start":const b=h.content_block;b.type==="thinking"?(r.showThinking&&(l=V(),i.querySelector(".message-content").appendChild(l)),a=b.thinking||""):b.type==="text"&&(c=document.createElement("div"),c.className="text-content",i.querySelector(".message-content").appendChild(c),u=b.text||"");break;case"content_block_delta":const I=h.delta;I.type==="thinking_delta"&&l?(a+=I.thinking||"",l.querySelector(".thinking-content").textContent=a):I.type==="text_delta"&&c&&(u+=I.text||"",c.innerHTML=X(u),void 0),r.autoScroll&&S();break;case"content_block_stop":break;case"message_stop":t.messages.push({role:"assistant",content:u,thinking:a||void 0}),t.updatedAt=Date.now();break;case"error":throw new Error(h.error?.message||"Stream error")}}catch(h){if(h.message!=="Stream error")console.warn("Parse error:",h);else throw h}}}}function Ee(){y&&y.abort()}function V(){const e=document.createElement("div");return e.className="thinking-block",e.innerHTML=`
        <div class="thinking-header" onclick="toggleThinking(this)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
            <span class="thinking-label">üß† Thinking...</span>
        </div>
        <div class="thinking-content"></div>
    `,e}function Ce(e){e.classList.toggle("collapsed"),e.nextElementSibling.classList.toggle("collapsed")}function K(e,t,n,s){const o=document.getElementById("chat-container"),i=Z(e),l=i.querySelector(".message-content");if(e==="assistant"&&s&&r.showThinking){const c=V();c.querySelector(".thinking-content").textContent=s,c.querySelector(".thinking-label").textContent="üß† Thinking process",l.appendChild(c)}if(n&&n.length>0){const c=document.createElement("div");c.className="message-images",n.forEach(a=>{const u=document.createElement("img");u.className="message-image",u.src=`data:${a.media_type};base64,${a.data}`,u.onclick=()=>window.open(u.src,"_blank"),c.appendChild(u)}),l.appendChild(c)}if(t){const c=typeof t=="string"?t:Array.isArray(t)?t.filter(a=>a.type==="text").map(a=>a.text).join(""):"";if(c){const a=document.createElement("div");a.className="text-content",a.innerHTML=X(c),l.appendChild(a)}}o.appendChild(i),S()}function Te(e){const t=document.getElementById("chat-container"),n=document.createElement("div");n.className="message assistant",n.innerHTML=`
        <div class="message-header">
            <div class="message-avatar" style="background: var(--error);">‚ö†Ô∏è</div>
            <span class="message-role">Error</span>
        </div>
        <div class="message-content" style="color: var(--error);">
            ${H(e)}
        </div>
    `,t.appendChild(n),S()}function X(e){let t=marked.parse(e);return t=t.replace(/<pre><code class="language-(\w+)">/g,'<pre><div class="code-header"><span class="code-lang">$1</span><button class="copy-btn" onclick="copyCode(this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy</button></div><code class="language-$1">'),t=t.replace(/<pre><code>/g,'<pre><div class="code-header"><span class="code-lang">code</span><button class="copy-btn" onclick="copyCode(this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy</button></div><code>'),t}async function xe(e){const n=e.closest("pre").querySelector("code").textContent;try{await navigator.clipboard.writeText(n),e.classList.add("copied"),e.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg> Copied!',setTimeout(()=>{e.classList.remove("copied"),e.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy'},2e3)}catch{m("Failed to copy","error")}}function q(e){const t=document.getElementById("send-btn"),n=document.getElementById("stop-btn"),s=document.getElementById("message-input");e?(t.classList.add("hidden"),n.classList.remove("hidden"),s.disabled=!0):(t.classList.remove("hidden"),n.classList.add("hidden"),s.disabled=!1,s.focus())}function S(){const e=document.getElementById("chat-container");e.scrollTop=e.scrollHeight}function Y(e){e.style.height="auto",e.style.height=Math.min(e.scrollHeight,200)+"px"}function A(){const e=document.getElementById("message-input"),t=document.getElementById("char-count");t&&e&&(t.textContent=`${e.value.length} characters`)}function Be(e){e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),J())}function Le(e){const t=document.getElementById("message-input");t.value=e,t.focus(),Y(t),A()}function Se(){const e=document.getElementById("message-input");e&&(e.focus(),e.style.boxShadow="0 0 0 3px rgba(99, 102, 241, 0.3)",setTimeout(()=>{e.style.boxShadow=""},500))}function M(){return`
        <div class="welcome-screen" id="welcome-screen">
            <div class="welcome-logo">üöÄ</div>
            <h1>Welcome to Arafat Chat</h1>
            <p>Powered by Claude & Gemini AI models through Antigravity Proxy</p>
            <div class="quick-actions">
                <button class="quick-action" onclick="setPrompt('Explain quantum computing in simple terms')">
                    <span class="quick-icon">üí°</span>
                    <span>Explain quantum computing</span>
                </button>
                <button class="quick-action" onclick="setPrompt('Write a Python function to sort a list')">
                    <span class="quick-icon">üíª</span>
                    <span>Write Python code</span>
                </button>
                <button class="quick-action" onclick="setPrompt('What are the latest trends in AI?')">
                    <span class="quick-icon">ü§ñ</span>
                    <span>AI trends</span>
                </button>
                <button class="quick-action" onclick="setPrompt('Help me write a professional email')">
                    <span class="quick-icon">‚úâÔ∏è</span>
                    <span>Write an email</span>
                </button>
            </div>
        </div>
    `}async function Q(){const e=document.getElementById("connection-status");if(!e)return;const t=e.querySelector(".status-text");if(t){if(!r.apiUrl){e.className="connection-pill",e.classList.remove("hidden"),t.textContent="API URL not configured";return}e.className="connection-pill connecting",e.classList.remove("hidden"),t.textContent="Connecting...";try{const n=await fetch(`${r.apiUrl}/health`,{headers:{"ngrok-skip-browser-warning":"true"}});if(n.ok){const s=await n.json();e.className="connection-pill connected",t.textContent=`Connected ‚Ä¢ ${s.accounts||"Proxy ready"}`}else throw new Error("Bad response")}catch{e.className="connection-pill error",t.textContent="Connection failed - check Settings"}}}function m(e,t="info"){const n=document.getElementById("toast-container"),s={success:"‚úì",error:"‚úï",warning:"‚ö†",info:"‚Ñπ"},o=document.createElement("div");o.className=`toast ${t}`,o.innerHTML=`
        <span class="toast-icon">${s[t]||s.info}</span>
        <span class="toast-message">${H(e)}</span>
    `,n.appendChild(o),setTimeout(()=>{o.style.opacity="0",o.style.transform="translateX(100%)",setTimeout(()=>o.remove(),300)},4e3)}function H(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function Ae(){const e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(d,null,2)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","arafat_gpt_history_"+new Date().toISOString()+".json"),document.body.appendChild(t),t.click(),t.remove(),m("Chat history exported successfully","success")}function Me(){const e=document.getElementById("right-sidebar"),t=document.getElementById("robot-mascot");e&&(e.classList.toggle("closed"),e.classList.toggle("mobile-visible"),t&&(e.classList.contains("closed")?t.classList.add("hidden-by-sidebar"):t.classList.remove("hidden-by-sidebar")))}function Z(e){const t=document.createElement("div");t.className=`message ${e}`;const n=e==="user"?"üë§":"‚ú®";return t.innerHTML=`
        <div class="message-avatar">${n}</div>
        <div class="message-content"></div>
    `,t}window.toggleRightSidebar=Me;window.exportData=Ae;window.newChat=z;window.loadConversation=B;window.deleteConversation=fe;window.toggleTheme=ge;window.openSettings=G;window.closeSettings=x;window.saveSettings=me;window.clearAllData=ve;window.handleImageUpload=be;window.removeImage=Ie;window.sendMessage=J;window.stopGeneration=Ee;window.setPrompt=Le;window.focusChatInput=Se;window.handleKeyDown=Be;window.autoResize=Y;window.copyCode=xe;window.toggleThinking=Ce;window.attemptLogin=ne;window.togglePasswordVisibility=re;window.logout=ce;window.checkAuth=F;
