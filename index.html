<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arafat Pro GPT - AI Assistant</title>
    <meta name="description"
        content="Where silicon dreams meet human curiosity ‚Äî your neural co-pilot for intelligent conversations">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöÄ</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>

<body>
    <!-- üîê TOP SECRET LOGIN SCREEN üîê -->
    <div class="login-overlay" id="login-overlay">
        <div class="login-container">
            <div class="login-logo">üïµÔ∏è</div>
            <div class="classified-stamp">TOP SECRET</div>
            <h1 class="login-title">Agent Authentication Required</h1>
            <p class="login-subtitle">‚ö†Ô∏è This AI is so smart, we had to lock it up! ‚ö†Ô∏è</p>

            <form class="login-form" id="login-form" onsubmit="return attemptLogin(event)">
                <div class="login-field">
                    <label class="login-label">ü•∑ Secret Identity (Username)</label>
                    <input type="text" id="login-username" class="login-input" placeholder="Who dares to enter?"
                        autocomplete="off" required>
                    <span class="input-hint">Hint: It's not "admin" (we're not that basic)</span>
                </div>

                <div class="login-field">
                    <label class="login-label">üîë Super Secret Password</label>
                    <div class="password-wrapper">
                        <input type="password" id="login-password" class="login-input" placeholder="The magic words..."
                            required>
                        <button type="button" class="toggle-password" onclick="togglePasswordVisibility()">
                            <span id="eye-icon">üëÅÔ∏è</span>
                        </button>
                    </div>
                    <span class="input-hint">Hint: It's definitely not "password123" (we have standards)</span>
                </div>

                <div class="login-error" id="login-error"></div>

                <button type="submit" class="login-btn" id="login-btn">
                    <span class="btn-text">üöÄ Access the Brain</span>
                    <span class="btn-loading hidden">üîÑ Verifying your worthiness...</span>
                </button>
            </form>

            <div class="login-footer">
                <p class="attempts-counter" id="attempts-counter"></p>
                <p class="fun-fact" id="fun-fact">üí° Fun fact: This AI once calculated pi to 1 million digits... just
                    for fun!</p>
            </div>

            <div class="matrix-bg"></div>
        </div>
    </div>

    <div class="app-layout" id="app-container">
        <!-- 1. Left Icon Rail -->
        <nav class="icon-rail">
            <div class="rail-top">
                <button class="rail-btn new-chat-trigger" onclick="newChat()" title="New Chat">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
                <button class="rail-btn" title="Search">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </button>
                <button class="rail-btn" title="Explore">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon>
                    </svg>
                </button>
                <button class="rail-btn" title="Apps">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                </button>
            </div>
            <div class="rail-bottom">
                <button class="rail-btn" title="History" onclick="toggleRightSidebar()">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                </button>
                <button class="rail-btn" title="Logout" onclick="logout()">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                </button>
                <div class="user-avatar-small" onclick="openSettings()">üë§</div>
            </div>
        </nav>

        <!-- 2. Main Chat Area -->
        <main class="main-stage">
            <header class="chat-header">
                <h2 id="current-chat-title">New Conversation</h2>
                <div class="header-controls">
                    <button class="icon-btn" onclick="toggleTheme()">
                        <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </button>
                </div>
            </header>

            <div class="chat-viewport" id="chat-container">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcome-screen">
                    <div class="hero-text">
                        <h1>Good morning, Agent.</h1>
                        <p>What mission shall we embark on today?</p>
                    </div>
                </div>
                <!-- Messages go here -->
            </div>

            <div class="input-floater-container">
                <!-- Image Previews -->
                <div class="image-preview-bar" id="image-preview-container"></div>

                <div class="input-floater">
                    <button class="attach-btn-modern" onclick="document.getElementById('image-input').click()">
                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <path
                                d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                            </path>
                        </svg>
                        <input type="file" id="image-input" accept="image/*" multiple
                            onchange="handleImageUpload(event)" hidden>
                    </button>

                    <textarea id="message-input" placeholder="Type your message..." rows="1"
                        onkeydown="handleKeyDown(event)" oninput="autoResize(this)"></textarea>

                    <button class="send-btn-modern" id="send-btn" onclick="sendMessage()">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path d="M22 2L11 13" />
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" fill="none" />
                        </svg>
                    </button>
                    <button class="stop-btn-modern hidden" id="stop-btn" onclick="stopGeneration()">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <rect x="6" y="6" width="12" height="12" rx="2" />
                        </svg>
                    </button>
                </div>

                <div class="model-selector-pill">
                    <select id="model-select" class="model-select-transparent">
                        <optgroup label="Claude Models">
                            <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                            <option value="claude-sonnet-4-5-thinking">Claude Sonnet 4.5 (Thinking)</option>
                            <option value="claude-opus-4-5-thinking">Claude Opus 4.5 (Thinking)</option>
                        </optgroup>
                        <optgroup label="Gemini Models">
                            <option value="gemini-3-pro-low">Gemini 3 Pro</option>
                            <option value="gemini-3-pro-high">Gemini 3 Pro (High)</option>
                            <option value="gemini-3-flash">Gemini 3 Flash</option>
                            <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                            <option value="gemini-2.5-flash-thinking">Gemini 2.5 Flash (Thinking)</option>
                            <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite</option>
                            <option value="gemini-3-pro-image">Gemini 3 Pro (Image)</option>
                        </optgroup>
                    </select>
                </div>
            </div>

            <!-- Connection Indicator -->
            <div id="connection-status" class="connection-pill hidden">
                <span class="status-dot"></span>
                <span class="status-text">Checking...</span>
            </div>
        </main>

        <!-- 3. Right Sidebar (Context/History) -->
        <aside class="sidebar-right" id="right-sidebar">
            <div class="sidebar-section">
                <div class="sidebar-heading">
                    <span>Arafat Pro GPT</span>
                    <button class="icon-btn-small" onclick="toggleRightSidebar()">
                        <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2"
                            fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                    </button>
                </div>

                <div class="widget-list">
                    <div class="widget-item">
                        <span class="widget-icon">üìÖ</span>
                        <span>Calendar & Planning</span>
                    </div>
                    <div class="widget-item">
                        <span class="widget-icon">üìÅ</span>
                        <span>File Reader</span>
                    </div>
                    <div class="widget-item">
                        <span class="widget-icon">üñºÔ∏è</span>
                        <span>Media Files</span>
                        <span class="badge">31</span>
                    </div>
                </div>

                <button class="action-btn-block">
                    <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none">
                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                        <polyline points="16 6 12 2 8 6"></polyline>
                        <line x1="12" y1="2" x2="12" y2="15"></line>
                    </svg>
                    Share
                </button>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-heading">Today</div>
                <div class="conversations-list small" id="conversations-list">
                    <!-- Populated by JS -->
                </div>
            </div>
        </aside>

        <!-- 3D Robot Mascot (CSS only placeholder) -->
        <!-- 3D Robot Mascot -->
        <div class="robot-mascot" id="robot-mascot" onclick="focusChatInput()">
            <img src="/robot_mascot.png" alt="Robot Mascot">
            <div class="robot-bubble">
                Hello! from Arafat üí¨
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" onclick="closeSettings()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label class="setting-label">API Endpoint URL</label>
                    <input type="text" id="settings-api-url" class="setting-input"
                        placeholder="https://your-ngrok-url.ngrok-free.app">
                    <p class="setting-hint">Enter your Antigravity Proxy ngrok URL</p>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Default Model</label>
                    <select id="settings-default-model" class="setting-input">
                        <optgroup label="Claude Models">
                            <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                            <option value="claude-sonnet-4-5-thinking">Claude Sonnet 4.5 (Thinking)</option>
                            <option value="claude-opus-4-5-thinking">Claude Opus 4.5 (Thinking)</option>
                        </optgroup>
                        <optgroup label="Gemini Models">
                            <option value="gemini-3-pro-low">Gemini 3 Pro</option>
                            <option value="gemini-3-pro-high">Gemini 3 Pro (High)</option>
                            <option value="gemini-3-flash">Gemini 3 Flash</option>
                            <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                            <option value="gemini-2.5-flash-thinking">Gemini 2.5 Flash (Thinking)</option>
                            <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite</option>
                            <option value="gemini-3-pro-image">Gemini 3 Pro (Image)</option>
                        </optgroup>
                    </select>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Max Tokens</label>
                    <input type="number" id="settings-max-tokens" class="setting-input" value="8192" min="1"
                        max="32000">
                </div>

                <div class="setting-group">
                    <label class="setting-label">
                        <input type="checkbox" id="settings-show-thinking" checked>
                        Show AI thinking process
                    </label>
                </div>

                <div class="setting-group">
                    <label class="setting-label">
                        <input type="checkbox" id="settings-auto-scroll" checked>
                        Auto-scroll to new messages
                    </label>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Data Management</label>
                    <button class="btn-secondary" onclick="exportData()" style="width: 100%; margin-bottom: 10px;">üì•
                        Export Chat History (JSON)</button>
                    <button class="danger-btn" onclick="clearAllData()" style="margin-bottom: 10px;">üóëÔ∏è Clear All Conversations</button>
                </div>

                <div class="setting-group">
                    <label class="setting-label">Account</label>
                    <button class="danger-btn" onclick="logout(); closeSettings();">üö™ Logout</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeSettings()">Cancel</button>
                <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script type="module" src="/src/main.js"></script>
</body>

</html>